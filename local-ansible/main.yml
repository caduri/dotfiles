---
  - hosts: all
    gather_facts: yes
  
    vars_files:
      - default.config.yml
  
    pre_tasks:
      - include_vars: "{{ item }}"
        with_fileglob:
          - "{{ playbook_dir }}/config.yml"
        tags: ['always']
  
    roles:
      - role: geerlingguy.homebrew
        tags: ['homebrew']
      - role: geerlingguy.mas
        when: mas_installed_apps
        tags: ['mas']
      # - role: drew-kun.macos_terminal
      #   tags: ['macos_terminal']
      # - role: caduri.ohmyzsh
      #   tags: ['ohmyzsh']
  
    tasks:
      - include_tasks: tasks/iterm2.yml
        tags: ['iterm2']

      - include_role:
          name: myrole
        tags: ['ohmyzsh']
      # - include_tasks: tasks/osx.yml
      #   when: configure_osx
      #   tags: ['osx']
  
      - include_tasks: tasks/extra-packages.yml
        tags: ['extra-packages']
  
      - name: Run configured post-provision ansible task files.
        include_tasks: "{{ outer_item }}"
        loop_control:
          loop_var: outer_item
        with_fileglob: "{{ post_provision_tasks|default(omit) }}"
  